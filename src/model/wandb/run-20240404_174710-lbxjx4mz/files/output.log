
data_shape
START TRAINING DENOISER AT:  2595760449775
Training Denoiser. Epoch: 0
Iter 0: MSE - 0.3557191789150238
Iter 1: MSE - 1.461958408355713
Iter 2: MSE - 6.3778977394104
Iter 3: MSE - 2.827455997467041
Iter 4: MSE - 1.1566039323806763
Iter 5: MSE - 0.6532209515571594
Iter 6: MSE - 0.5038086771965027
Iter 7: MSE - 0.4651218354701996
Iter 8: MSE - 0.47286128997802734
Iter 9: MSE - 0.4715014696121216
Iter 10: MSE - 0.4620976746082306
Iter 11: MSE - 0.46068787574768066
Iter 12: MSE - 0.4487924873828888
Iter 13: MSE - 0.44556084275245667
Iter 14: MSE - 0.44382035732269287
Iter 15: MSE - 0.44525766372680664
Iter 16: MSE - 0.4372754693031311
Iter 17: MSE - 0.43461909890174866
Iter 18: MSE - 0.43862003087997437
Iter 19: MSE - 0.4294382631778717
Iter 20: MSE - 0.4316047430038452
Iter 21: MSE - 0.4203464686870575
Iter 22: MSE - 0.43258407711982727
Iter 23: MSE - 0.438113272190094
Iter 24: MSE - 0.4353061020374298
Iter 25: MSE - 0.4289840757846832
Iter 26: MSE - 0.4276178777217865
Iter 27: MSE - 0.4068043529987335
Iter 28: MSE - 0.40506333112716675
Iter 29: MSE - 0.40288177132606506
Iter 30: MSE - 0.3896198272705078
Iter 31: MSE - 0.3934987187385559
Iter 32: MSE - 0.3966134786605835
Iter 33: MSE - 0.38838306069374084
Iter 34: MSE - 0.4172811508178711
Iter 35: MSE - 0.40465089678764343
Iter 36: MSE - 0.40253159403800964
Iter 37: MSE - 0.3942960202693939
Iter 38: MSE - 0.39012476801872253
Iter 39: MSE - 0.3817463517189026
Iter 40: MSE - 0.3707192838191986
Iter 41: MSE - 0.367892324924469
Iter 42: MSE - 0.36530765891075134
Iter 43: MSE - 0.3449336588382721
Iter 44: MSE - 0.3257673382759094
Iter 45: MSE - 0.31341367959976196
Iter 46: MSE - 0.31246376037597656
Iter 47: MSE - 0.3071240782737732
Iter 48: MSE - 0.300409734249115
Iter 49: MSE - 0.2967185974121094
Iter 50: MSE - 0.3029896318912506
Iter 51: MSE - 0.29236921668052673
Iter 52: MSE - 0.30108630657196045
Iter 53: MSE - 0.2969319820404053
Iter 54: MSE - 0.3024078607559204
Iter 55: MSE - 0.30038872361183167
Iter 56: MSE - 0.2887997031211853
Iter 57: MSE - 0.2725760340690613
Iter 58: MSE - 0.2661092281341553
Iter 59: MSE - 0.26194921135902405
Iter 60: MSE - 0.25417736172676086
Iter 61: MSE - 0.2513104975223541
Iter 62: MSE - 0.24880653619766235
Iter 63: MSE - 0.2618238925933838
Iter 64: MSE - 0.2763494551181793
Iter 65: MSE - 0.28244465589523315
Iter 66: MSE - 0.2802216410636902
Iter 67: MSE - 0.26994192600250244
Iter 68: MSE - 0.2549271881580353
Iter 69: MSE - 0.24884235858917236
Iter 70: MSE - 0.23282651603221893
Iter 71: MSE - 0.22680193185806274
Iter 72: MSE - 0.21856872737407684
Iter 73: MSE - 0.20968882739543915
Iter 74: MSE - 0.2068607211112976
Iter 75: MSE - 0.20490297675132751
Iter 76: MSE - 0.20331095159053802
Iter 77: MSE - 0.20973289012908936
Iter 78: MSE - 0.21297571063041687
Iter 79: MSE - 0.21764938533306122
Iter 80: MSE - 0.21255527436733246
Iter 81: MSE - 0.19914861023426056
Iter 82: MSE - 0.2072012722492218
Iter 83: MSE - 0.2115524262189865
Iter 84: MSE - 0.18948227167129517
Iter 85: MSE - 0.1734819859266281
Iter 86: MSE - 0.16341236233711243
Iter 87: MSE - 0.15788672864437103
Iter 88: MSE - 0.16517774760723114
Iter 89: MSE - 0.16251219809055328
Iter 90: MSE - 0.1402578055858612
Iter 91: MSE - 0.15582585334777832
Iter 92: MSE - 0.16058743000030518
Iter 93: MSE - 0.17260602116584778
Iter 94: MSE - 0.16330307722091675
Iter 95: MSE - 0.14622284471988678
Iter 96: MSE - 0.13344602286815643
Iter 97: MSE - 0.12515021860599518
Iter 98: MSE - 0.11666081100702286
Iter 99: MSE - 0.11787545680999756
Iter 100: MSE - 0.11388321220874786
Iter 101: MSE - 0.1289067417383194
Iter 102: MSE - 0.13488662242889404
Iter 103: MSE - 0.13558638095855713
Iter 104: MSE - 0.10540730506181717
Iter 105: MSE - 0.10296787321567535
Iter 106: MSE - 0.097834013402462
Iter 107: MSE - 0.10050259530544281
Iter 108: MSE - 0.099305659532547
Iter 109: MSE - 0.10406169295310974
Iter 110: MSE - 0.09667626768350601
Iter 111: MSE - 0.10283134877681732
Iter 112: MSE - 0.10862628370523453
Iter 113: MSE - 0.09703654050827026
Iter 114: MSE - 0.11854375153779984
Iter 115: MSE - 0.13343088328838348
Iter 116: MSE - 0.12011025100946426
Iter 117: MSE - 0.10915374010801315
Iter 118: MSE - 0.10357517004013062
Iter 119: MSE - 0.10899966955184937
Iter 120: MSE - 0.11677108705043793
Iter 121: MSE - 0.10391875356435776
Iter 122: MSE - 0.09950361400842667
Iter 123: MSE - 0.08163945376873016
Iter 124: MSE - 0.07557681947946548
Iter 125: MSE - 0.07590513676404953
Iter 126: MSE - 0.09020408987998962
Iter 127: MSE - 0.11188241839408875
Iter 128: MSE - 0.09425120800733566
Iter 129: MSE - 0.08620163053274155
Iter 130: MSE - 0.08648879826068878
Iter 131: MSE - 0.08492516726255417
Iter 132: MSE - 0.0637161061167717
Iter 133: MSE - 0.08400474488735199
Iter 134: MSE - 0.11515150964260101
Iter 135: MSE - 0.1393452286720276
Iter 136: MSE - 0.11794552206993103
Iter 137: MSE - 0.11204652488231659
Iter 138: MSE - 0.10141672194004059
Iter 139: MSE - 0.10484613478183746
Iter 140: MSE - 0.08830486983060837
Iter 141: MSE - 0.08927000313997269
Iter 142: MSE - 0.08137904852628708
Iter 143: MSE - 0.0748167410492897
Iter 144: MSE - 0.0726168304681778
Iter 145: MSE - 0.07378799468278885
Iter 146: MSE - 0.06884603202342987
Iter 147: MSE - 0.0700191855430603
Iter 148: MSE - 0.056827303022146225
Iter 149: MSE - 0.06479276716709137
Iter 150: MSE - 0.06814458221197128
Iter 151: MSE - 0.06398466229438782
Iter 152: MSE - 0.061336763203144073
Iter 153: MSE - 0.05734747648239136
Iter 154: MSE - 0.07003632187843323
Iter 155: MSE - 0.0809360221028328
Iter 156: MSE - 0.06394578516483307
Iter 157: MSE - 0.051338616758584976
Iter 158: MSE - 0.0557682141661644
Iter 159: MSE - 0.04740556329488754
Iter 160: MSE - 0.050088025629520416
Iter 161: MSE - 0.05352361127734184
Iter 162: MSE - 0.04666833579540253
Iter 163: MSE - 0.05320176109671593
Iter 164: MSE - 0.055099375545978546
Iter 165: MSE - 0.05479897931218147
Iter 166: MSE - 0.07155023515224457
Iter 167: MSE - 0.05850369483232498
Iter 168: MSE - 0.058565814048051834
Iter 169: MSE - 0.06064428389072418
Iter 170: MSE - 0.06390500068664551
Iter 171: MSE - 0.06624294817447662
Iter 172: MSE - 0.05637778714299202
Iter 173: MSE - 0.04836941882967949
Iter 174: MSE - 0.056414950639009476
Iter 175: MSE - 0.05885273218154907
Iter 176: MSE - 0.07599595934152603
Iter 177: MSE - 0.04337667301297188
Iter 178: MSE - 0.05561055615544319
Iter 179: MSE - 0.048256296664476395
Iter 180: MSE - 0.03427935391664505
Iter 181: MSE - 0.043913573026657104
Iter 182: MSE - 0.05403228476643562
Iter 183: MSE - 0.039789311587810516
Iter 184: MSE - 0.04683893546462059
Iter 185: MSE - 0.061555780470371246
Iter 186: MSE - 0.042929988354444504
Iter 187: MSE - 0.05324803292751312
Iter 188: MSE - 0.04772106930613518
Iter 189: MSE - 0.03629622235894203
Iter 190: MSE - 0.057864710688591
Iter 191: MSE - 0.05038212984800339
Iter 192: MSE - 0.07049363851547241
Iter 193: MSE - 0.08356666564941406
Iter 194: MSE - 0.05119795724749565
Iter 195: MSE - 0.05114838480949402
Iter 196: MSE - 0.04427163302898407
Iter 197: MSE - 0.04309961572289467
Iter 198: MSE - 0.03585425019264221
Iter 199: MSE - 0.03422728180885315
Iter 200: MSE - 0.029274191707372665
Iter 201: MSE - 0.03260001167654991
Iter 202: MSE - 0.027841905131936073
Iter 203: MSE - 0.029640330001711845
Iter 204: MSE - 0.03159741684794426
Iter 205: MSE - 0.03499545156955719
Iter 206: MSE - 0.02587248384952545
Iter 207: MSE - 0.027454769238829613
Iter 208: MSE - 0.04636547341942787
Iter 209: MSE - 0.03303515166044235
Iter 210: MSE - 0.0443103201687336
Iter 211: MSE - 0.04319408908486366
Iter 212: MSE - 0.04018867760896683
Iter 213: MSE - 0.03910840302705765
Iter 214: MSE - 0.0432455874979496
Iter 215: MSE - 0.033995602279901505
Iter 216: MSE - 0.03233855590224266
Iter 217: MSE - 0.043863363564014435
Iter 218: MSE - 0.0311567559838295
Iter 219: MSE - 0.033968083560466766
Iter 220: MSE - 0.03006667271256447
Iter 221: MSE - 0.0306603591889143
Iter 222: MSE - 0.03534555062651634
Iter 223: MSE - 0.032605476677417755
Iter 224: MSE - 0.027502737939357758
Iter 225: MSE - 0.031126469373703003
Iter 226: MSE - 0.03347040340304375
Iter 227: MSE - 0.038817595690488815
Iter 228: MSE - 0.03309569135308266
Iter 229: MSE - 0.03321211412549019
Iter 230: MSE - 0.0416911356151104
Iter 231: MSE - 0.0399695560336113
Iter 232: MSE - 0.04201756417751312
Iter 233: MSE - 0.03828807920217514
Iter 234: MSE - 0.03273827210068703
Iter 235: MSE - 0.029910128563642502
Iter 236: MSE - 0.025637973099946976
Iter 237: MSE - 0.0245809443295002
Iter 238: MSE - 0.01897873356938362
Iter 239: MSE - 0.023462558165192604
Iter 240: MSE - 0.03038874641060829
Iter 241: MSE - 0.029780054464936256
Iter 242: MSE - 0.030132295563817024
Iter 243: MSE - 0.035439491271972656
Iter 244: MSE - 0.03474089503288269
Iter 245: MSE - 0.03721846267580986
Iter 246: MSE - 0.023892445489764214
Iter 247: MSE - 0.03750337287783623
Iter 248: MSE - 0.03744117170572281
Iter 249: MSE - 0.028007403016090393
Iter 250: MSE - 0.02306230179965496
Iter 251: MSE - 0.024860844016075134
Iter 252: MSE - 0.024295158684253693
Iter 253: MSE - 0.025552956387400627
Iter 254: MSE - 0.022378670051693916
Iter 255: MSE - 0.02732708491384983
Iter 256: MSE - 0.025498677045106888
Iter 257: MSE - 0.018294647336006165
Iter 258: MSE - 0.029100291430950165
Validating Denoiser. Epoch: 0
Denoiser Model is saved at epoch 0
END TRAINING DENOISER----- <built-in function perf_counter_ns>
Testing Denoiser
100%|██████████| 33/33 [00:01<00:00, 17.29it/s]
/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/init.py:412: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Traceback (most recent call last):
  File "/tmp/ipykernel_5348/3812810853.py", line 105, in training
    trainer_cb.train_epoch()
  File "/tmp/ipykernel_5348/453035365.py", line 124, in train_epoch
    predict = self.model(data)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/tmp/ipykernel_5348/1615517668.py", line 12, in forward
    output = self.predictor(encoded)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/tmp/ipykernel_5348/3528832199.py", line 105, in forward
    x = self.cnn(x)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/tmp/ipykernel_5348/1051490638.py", line 35, in forward
    softmax_attention = self.attention(x).unsqueeze(2).unsqueeze(4)    # size : [bs, n_ker, 1, freqs, 1]
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/tmp/ipykernel_5348/1051490638.py", line 105, in forward
    x = self.conv1d1(x)               #x size : [bs, hid_chan, frames]
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 310, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 306, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Calculated padded input size per channel: (4). Kernel size: (7). Kernel size can't be greater than actual input size
START TRAINING ESTIMATOR AT:  2697902830663
Training Estimator.  Epoch 0
torch.Size([128, 252, 8, 34])