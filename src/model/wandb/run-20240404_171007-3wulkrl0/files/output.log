
data_shape
START TRAINING DENOISER AT:  379211444848
Training Denoiser. Epoch: 0
Iter 0: MSE - 0.3726307153701782
Iter 1: MSE - 0.7644692659378052
Iter 2: MSE - 2.171138048171997
Iter 3: MSE - 1.8719204664230347
Iter 4: MSE - 3.116190195083618
Iter 5: MSE - 0.5444656014442444
Iter 6: MSE - 0.5627574920654297
Iter 7: MSE - 0.4695766866207123
Iter 8: MSE - 0.34473440051078796
Iter 9: MSE - 0.29749223589897156
Iter 10: MSE - 0.2900102436542511
Iter 11: MSE - 0.2807229161262512
Iter 12: MSE - 0.27275872230529785
Iter 13: MSE - 0.24979649484157562
Iter 14: MSE - 0.250407874584198
Iter 15: MSE - 0.2529442310333252
Iter 16: MSE - 0.25281232595443726
Iter 17: MSE - 0.2381235808134079
Iter 18: MSE - 0.26794156432151794
Iter 19: MSE - 0.24568091332912445
Iter 20: MSE - 0.25638556480407715
Iter 21: MSE - 0.23172627389431
Iter 22: MSE - 0.22270911931991577
Iter 23: MSE - 0.22356733679771423
Iter 24: MSE - 0.2099132537841797
Iter 25: MSE - 0.19181254506111145
Iter 26: MSE - 0.19240924715995789
Iter 27: MSE - 0.18081505596637726
Iter 28: MSE - 0.16658353805541992
Iter 29: MSE - 0.16389212012290955
Iter 30: MSE - 0.1575360894203186
Iter 31: MSE - 0.1477595865726471
Iter 32: MSE - 0.14446096122264862
Iter 33: MSE - 0.15034374594688416
Iter 34: MSE - 0.1381501406431198
Iter 35: MSE - 0.14939075708389282
Iter 36: MSE - 0.14092184603214264
Iter 37: MSE - 0.14120633900165558
Iter 38: MSE - 0.17241093516349792
Iter 39: MSE - 0.16884520649909973
Iter 40: MSE - 0.15687209367752075
Iter 41: MSE - 0.1356942057609558
Iter 42: MSE - 0.14237146079540253
Iter 43: MSE - 0.1244022473692894
Iter 44: MSE - 0.121075838804245
Iter 45: MSE - 0.1124921664595604
Iter 46: MSE - 0.13123510777950287
Iter 47: MSE - 0.11436446011066437
Iter 48: MSE - 0.1205625832080841
Iter 49: MSE - 0.11622218787670135
Iter 50: MSE - 0.10167652368545532
Iter 51: MSE - 0.10380443185567856
Iter 52: MSE - 0.11738310754299164
Iter 53: MSE - 0.10908811539411545
Iter 54: MSE - 0.09392441064119339
Iter 55: MSE - 0.09311613440513611
Iter 56: MSE - 0.11248856037855148
Iter 57: MSE - 0.10966632515192032
Iter 58: MSE - 0.09445364773273468
Iter 59: MSE - 0.1109384298324585
Iter 60: MSE - 0.12709836661815643
Iter 61: MSE - 0.12245169281959534
Iter 62: MSE - 0.0993572250008583
Iter 63: MSE - 0.1078416258096695
Iter 64: MSE - 0.11834719032049179
Iter 65: MSE - 0.11792640388011932
Iter 66: MSE - 0.09529069066047668
Iter 67: MSE - 0.12002533674240112
Iter 68: MSE - 0.13645920157432556
Iter 69: MSE - 0.1103910431265831
Iter 70: MSE - 0.09489612281322479
Iter 71: MSE - 0.10809310525655746
Iter 72: MSE - 0.11878766119480133
Iter 73: MSE - 0.09718289226293564
Iter 74: MSE - 0.0835438147187233
Iter 75: MSE - 0.08547807484865189
Iter 76: MSE - 0.08284737169742584
Iter 77: MSE - 0.08980532735586166
Iter 78: MSE - 0.07075165212154388
Iter 79: MSE - 0.08435816317796707
Iter 80: MSE - 0.09495337307453156
Iter 81: MSE - 0.09076708555221558
Iter 82: MSE - 0.07097753137350082
Iter 83: MSE - 0.07224097102880478
Iter 84: MSE - 0.060329411178827286
Iter 85: MSE - 0.05591513216495514
Iter 86: MSE - 0.05879279598593712
Iter 87: MSE - 0.05481294170022011
Iter 88: MSE - 0.060389164835214615
Iter 89: MSE - 0.061094168573617935
Iter 90: MSE - 0.06445685029029846
Iter 91: MSE - 0.09074525535106659
Iter 92: MSE - 0.11641057580709457
Iter 93: MSE - 0.09172923862934113
Iter 94: MSE - 0.07454701513051987
Iter 95: MSE - 0.0749773383140564
Iter 96: MSE - 0.06284058839082718
Iter 97: MSE - 0.06726433336734772
Iter 98: MSE - 0.06776237487792969
Iter 99: MSE - 0.055399782955646515
Iter 100: MSE - 0.05733700469136238
Iter 101: MSE - 0.05947263166308403
Iter 102: MSE - 0.05962688848376274
Iter 103: MSE - 0.05961256101727486
Iter 104: MSE - 0.08949939161539078
Iter 105: MSE - 0.10249147564172745
Iter 106: MSE - 0.09186722338199615
Iter 107: MSE - 0.06584130227565765
Iter 108: MSE - 0.07470092177391052
Iter 109: MSE - 0.06547621637582779
Iter 110: MSE - 0.06293080747127533
Iter 111: MSE - 0.07022921741008759
Iter 112: MSE - 0.060926664620637894
Iter 113: MSE - 0.0655723363161087
Iter 114: MSE - 0.08110100775957108
Iter 115: MSE - 0.08314491808414459
Iter 116: MSE - 0.06692370772361755
Iter 117: MSE - 0.061306655406951904
Iter 118: MSE - 0.060317691415548325
Iter 119: MSE - 0.0550432987511158
Iter 120: MSE - 0.04845750331878662
Iter 121: MSE - 0.04667464643716812
Iter 122: MSE - 0.04489969462156296
Iter 123: MSE - 0.05265162140130997
Iter 124: MSE - 0.03784366324543953
Iter 125: MSE - 0.05909161642193794
Iter 126: MSE - 0.06668561697006226
Iter 127: MSE - 0.06748494505882263
Iter 128: MSE - 0.05480875447392464
Iter 129: MSE - 0.06319744884967804
Iter 130: MSE - 0.05700632557272911
Iter 131: MSE - 0.04421692341566086
Iter 132: MSE - 0.040627818554639816
Iter 133: MSE - 0.04106371849775314
Iter 134: MSE - 0.03384513035416603
Iter 135: MSE - 0.03486019745469093
Iter 136: MSE - 0.03161386400461197
Iter 137: MSE - 0.02893778495490551
Iter 138: MSE - 0.026807527989149094
Iter 139: MSE - 0.029398217797279358
Iter 140: MSE - 0.02538112737238407
Iter 141: MSE - 0.024594102054834366
Iter 142: MSE - 0.025253277271986008
Iter 143: MSE - 0.03130879998207092
Iter 144: MSE - 0.04000852629542351
Iter 145: MSE - 0.038024406880140305
Iter 146: MSE - 0.0382765531539917
Iter 147: MSE - 0.050110239535570145
Iter 148: MSE - 0.062199581414461136
Iter 149: MSE - 0.06682983785867691
Iter 150: MSE - 0.04628632217645645
Iter 151: MSE - 0.04275442659854889
Iter 152: MSE - 0.040307313203811646
Iter 153: MSE - 0.035447992384433746
Iter 154: MSE - 0.026663919910788536
Iter 155: MSE - 0.03401416167616844
Iter 156: MSE - 0.03165719658136368
Iter 157: MSE - 0.02667374722659588
Iter 158: MSE - 0.02645955979824066
Iter 159: MSE - 0.026161234825849533
Iter 160: MSE - 0.02542354352772236
Iter 161: MSE - 0.02384352684020996
Iter 162: MSE - 0.03825461119413376
Iter 163: MSE - 0.03915931284427643
Iter 164: MSE - 0.03635495528578758
Iter 165: MSE - 0.0308753103017807
Iter 166: MSE - 0.031226402148604393
Iter 167: MSE - 0.02627529948949814
Iter 168: MSE - 0.03149133548140526
Iter 169: MSE - 0.028502829372882843
Iter 170: MSE - 0.033997148275375366
Iter 171: MSE - 0.03997460752725601
Iter 172: MSE - 0.033642616122961044
Iter 173: MSE - 0.0454593189060688
Iter 174: MSE - 0.03429299220442772
Iter 175: MSE - 0.041234616190195084
Iter 176: MSE - 0.03192269802093506
Iter 177: MSE - 0.03565802052617073
Iter 178: MSE - 0.039674513041973114
Iter 179: MSE - 0.02697061002254486
Iter 180: MSE - 0.0361909382045269
Iter 181: MSE - 0.029723569750785828
Iter 182: MSE - 0.0373367965221405
Iter 183: MSE - 0.036637093871831894
Iter 184: MSE - 0.029504192993044853
Iter 185: MSE - 0.02602161280810833
Iter 186: MSE - 0.021757125854492188
Iter 187: MSE - 0.021713675931096077
Iter 188: MSE - 0.019394489005208015
Iter 189: MSE - 0.018397849053144455
Iter 190: MSE - 0.02166224829852581
Iter 191: MSE - 0.024020953103899956
Iter 192: MSE - 0.023519137874245644
Iter 193: MSE - 0.023874040693044662
Iter 194: MSE - 0.028092792257666588
Iter 195: MSE - 0.035861819982528687
Iter 196: MSE - 0.030125528573989868
Iter 197: MSE - 0.034391846507787704
Iter 198: MSE - 0.030769772827625275
Iter 199: MSE - 0.02837689407169819
Iter 200: MSE - 0.023080425336956978
Iter 201: MSE - 0.022821631282567978
Iter 202: MSE - 0.020457368344068527
Iter 203: MSE - 0.020661063492298126
Iter 204: MSE - 0.019861670210957527
Iter 205: MSE - 0.017101846635341644
Iter 206: MSE - 0.01502506248652935
Iter 207: MSE - 0.013866887427866459
Iter 208: MSE - 0.01439626794308424
Iter 209: MSE - 0.020827237516641617
Iter 210: MSE - 0.02450021356344223
Iter 211: MSE - 0.022181378677487373
Iter 212: MSE - 0.01716022938489914
Iter 213: MSE - 0.028232362121343613
Iter 214: MSE - 0.027555743232369423
Iter 215: MSE - 0.035453300923109055
Iter 216: MSE - 0.03466389328241348
Iter 217: MSE - 0.022080061957240105
Iter 218: MSE - 0.02425103262066841
Iter 219: MSE - 0.03180147334933281
Iter 220: MSE - 0.030661653727293015
Iter 221: MSE - 0.024474890902638435
Iter 222: MSE - 0.023204060271382332
Iter 223: MSE - 0.02026255987584591
Iter 224: MSE - 0.02279628999531269
Iter 225: MSE - 0.018762439489364624
Iter 226: MSE - 0.025883954018354416
Iter 227: MSE - 0.03204800561070442
Iter 228: MSE - 0.026470385491847992
Iter 229: MSE - 0.02103469893336296
Iter 230: MSE - 0.022204404696822166
Iter 231: MSE - 0.016782162711024284
Iter 232: MSE - 0.017326785251498222
Iter 233: MSE - 0.015969304367899895
Iter 234: MSE - 0.016061346977949142
Iter 235: MSE - 0.014703167602419853
Iter 236: MSE - 0.01742416061460972
Iter 237: MSE - 0.01920945942401886
Iter 238: MSE - 0.02737262099981308
Iter 239: MSE - 0.03305869922041893
Iter 240: MSE - 0.033840250223875046
Iter 241: MSE - 0.03095053881406784
Iter 242: MSE - 0.0396745502948761
Iter 243: MSE - 0.0325537733733654
Iter 244: MSE - 0.029125485569238663
Iter 245: MSE - 0.022791339084506035
Iter 246: MSE - 0.022169817239046097
Iter 247: MSE - 0.01692240498960018
Iter 248: MSE - 0.01682269386947155
Iter 249: MSE - 0.01607775315642357
Iter 250: MSE - 0.016625437885522842
Iter 251: MSE - 0.021659689024090767
Iter 252: MSE - 0.016315674409270287
Iter 253: MSE - 0.022456075996160507
Iter 254: MSE - 0.026213470846414566
Iter 255: MSE - 0.020995551720261574
Iter 256: MSE - 0.018126703798770905
Iter 257: MSE - 0.024213392287492752
Iter 258: MSE - 0.01897343061864376
Validating Denoiser. Epoch: 0
Denoiser Model is saved at epoch 0
END TRAINING DENOISER----- <built-in function perf_counter_ns>
Testing Denoiser
100%|██████████| 33/33 [00:01<00:00, 17.51it/s]
/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/init.py:412: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
START TRAINING ESTIMATOR AT:  478251690633
Training Estimator.  Epoch 0
torch.Size([512, 185, 5, 22])
Traceback (most recent call last):
  File "/tmp/ipykernel_5348/3812810853.py", line 105, in training
    trainer_cb.train_epoch()
  File "/tmp/ipykernel_5348/453035365.py", line 124, in train_epoch
    predict = self.model(data)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/tmp/ipykernel_5348/1615517668.py", line 12, in forward
    output = self.predictor(encoded)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/tmp/ipykernel_5348/3528832199.py", line 105, in forward
    x = self.cnn(x)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/modules/pooling.py", line 166, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/_jit_internal.py", line 488, in fn
    return if_false(*args, **kwargs)
  File "/home/nxhoang/Work/HPE/venv/lib/python3.8/site-packages/torch/nn/functional.py", line 791, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
RuntimeError: Given input size: (41x1x18). Calculated output size: (41x0x4). Output size is too small